{% load staticfiles %}

<script>
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

<!-- JQUERY -->
<script type="text/javascript" src="{% static 'bower_components/jquery/dist/jquery.min.js' %}"></script>

<script>
    $( document ).ready(function() {
        $("#loading").css('display', 'none');
        $("#page-content").css('display', 'block');

        $("#nav-menu").css('display', 'inherit');
    });
</script>

<!-- google mapp -->
<script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=places&language=es-AR"></script>
<script type="text/javascript" src="{% static 'bower_components/ng-ckeditor/libs/ckeditor/ckeditor.js' %}"></script>
<script type="application/javascript" src="{% static 'production/dashboard/concat-lib.js' %}"></script>
<script type="text/javascript" src="{% static 'bower_components/toastr/toastr.js' %}"></script>

{% load jsonify %}
<script>

        angular
            .module('authentication', [])
            .factory('Authentication', Authentication);

            Authentication.$inject = [];

            function Authentication(){
                // Print user data with django
                var user = {{ user_data|jsonify }};

                var _unread_msg = user.msg_unread;

                var Authentication = {
                    setProfile: setProfile,
                    profile: user.profile,
                    has_items: user.has_items,
                    notification_unread: user.notification_unread,
                    msg_unread: get_msgs_unread,
                    unauthenticate: unauthenticate,
                    set_msg_read: set_read_msgs,
                    has_address: user.has_address
                };

                function getProfile(){
                    return user.profile;
                }


                function setProfile(profile){
                    user.profile = profile;
                }

                function unauthenticate(){
                    delete user;
                }

                function set_read_msgs(arra_msg_unread){
                    if(arra_msg_unread && arra_msg_unread.length > 0){
                        for(var i =0; i < arra_msg_unread.length; i++){
                            _unread_msg = _unread_msg -1;
                            angular.element('#msg-unread-' + String(arra_msg_unread[i]['id'])).remove()
                        }
                    }
                }

                function get_msgs_unread(){
                    return _unread_msg;
                }

                return Authentication
            }
</script>

<script>
    toastr.options = {
      "closeButton": true,
      "debug": false,
      "newestOnTop": false,
      "progressBar": true,
      "positionClass": "toast-bottom-left",
      "preventDuplicates": false,
      "onclick": null,
      "showDuration": "300",
      "hideDuration": "1000",
      "timeOut": "5000",
      "extendedTimeOut": "1000",
      "showEasing": "swing",
      "hideEasing": "linear",
      "showMethod": "fadeIn",
      "hideMethod": "fadeOut"
    };
    {% if messages %}
        {% for message in messages %}
            {% if message.tags and message.tags == 'success' %}
                toastr.success('{{ message }}');
            {% elif message.tags and message.tags == 'warning' %}
                toastr.warning('{{ message }}');
            {% elif message.tags and message.tags == 'error' %}
                toastr.error('{{ message }}');
            {% else %}
                toastr.info('{{ message }}');
            {% endif %}
        {% endfor %}
    {% endif %}

</script>

<script type="application/javascript" src="{% static 'production/dashboard/concat-app.js' %}"></script>
